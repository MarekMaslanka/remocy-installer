<?xml version="1.0" encoding="UTF-8"?>
<?define ProductVersion = "0.0.1"?>
<?define ProductUpgradeCode = "12345678-1234-1234-1234-111111111111"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" UpgradeCode="$(var.ProductUpgradeCode)" Name="Example Product Name" Version="$(var.ProductVersion)" Manufacturer="Example Company Name" Language="1033">
		<Package InstallerVersion="200" Compressed="yes" Comments="Windows Installer Package" />
		<Media Id="1" Cabinet="product.cab" EmbedCab="yes" />
		<UIRef Id="Custom_InstallDir"/>
		<Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
		<Property Id="INSTALLSHORTCUT" Secure="yes" />
		<Icon Id="ProductIcon" SourceFile="lunremote.exe" />
		<Property Id="ARPPRODUCTICON" Value="ProductIcon"/>
		<Property Id="ARPHELPLINK" Value="http://www.lunremote.pl" />
		<Property Id="ARPURLINFOABOUT" Value="http://www.lunremote.pl" />
		<Property Id="ARPNOREPAIR" Value="1" />
		<!-- <Property Id="ARPNOMODIFY" Value="1" /> -->
		<Upgrade Id="$(var.ProductUpgradeCode)">
			<UpgradeVersion Minimum="$(var.ProductVersion)" OnlyDetect="yes" Property="NEWERVERSIONDETECTED" />
			<UpgradeVersion Minimum="0.0.0" Maximum="$(var.ProductVersion)" IncludeMinimum="yes" IncludeMaximum="no" Property="OLDERVERSIONBEINGUPGRADED" />
		</Upgrade>
		<Condition Message="A newer version of this software is already installed.">NOT NEWERVERSIONDETECTED</Condition>
		<WixVariable Id="WixUILicenseRtf" Value="license.rtf" />
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFiles64Folder">
				<Directory Id="INSTALLDIR" Name="Lunremote">

					<Component Id="InstallRegistryComponent" Guid="*">
            <RegistryKey Id='ChessInfoBarInstallDir' Root='HKLM' Key='Software\Lunremote' Action='createAndRemoveOnUninstall'>
              <RegistryValue Type='string' Name='InstallDir' Value="[INSTALLDIR]" Action="write" KeyPath="yes" />
              <!--<RegistryValue Type='integer' Name='Flag' Value='0'/>-->
            </RegistryKey>
          </Component>

					<Component Id="ApplicationFiles" Guid="12345678-1234-1234-1234-222222222222">
						<File Id="ApplicationFile1" Source="lunremote.exe" />
					</Component>
				</Directory>
			</Directory>
			<Directory Id="DesktopFolder" Name="Desktop">
				<Component Id="ApplicationShortcutDesktop" Guid="*">
					<Condition>INSTALLDESKTOPSHORTCUT</Condition>
					<Shortcut Id="ApplicationDesktopShortcut" Name="Text under your icon" Description="Comment field in your shortcut" Target="[INSTALLDIR]lunremote.exe" WorkingDirectory="INSTALLDIR" />
					<RemoveFolder Id="DesktopFolder" On="uninstall"/>
					<RegistryValue Root="HKCU" Key="Software\Lunremote" Name="installed" Type="integer" Value="1" KeyPath="yes" />
				</Component>
			</Directory>
			<Directory Id="ProgramMenuFolder">
				<Directory Id="ProgramMenuSubfolder" Name="Lunremote">
					<Component Id="ApplicationShortcuts" Guid="12345678-1234-1234-1234-333333333333">
						<Condition>INSTALLSHORTCUT</Condition>
						<Shortcut Id="ApplicationShortcut1" Name="Example Shortcut Name" Description="Example Product Name" Target="[INSTALLDIR]lunremote.exe" WorkingDirectory="INSTALLDIR" />
						<RegistryValue Root="HKCU" Key="Software\Lunremote" Name="installed" Type="integer" Value="1" KeyPath="yes" />
						<RemoveFolder Id="ProgramMenuSubfolder" On="uninstall" />
					</Component>
				</Directory>
			</Directory>
		</Directory>
		<InstallExecuteSequence>
			<RemoveExistingProducts After="InstallValidate" />
		</InstallExecuteSequence>
		<Feature Id="DefaultFeature" Level="1">
			<ComponentRef Id="ApplicationFiles" />
			<ComponentRef Id="ApplicationShortcuts" />
			<ComponentRef Id="InstallRegistryComponent" />
			<ComponentRef Id="ApplicationShortcutDesktop" />
		</Feature>
		<!--	<CustomAction ExeCommand="" FileKey="GuiProgram" Id="StartGui" Return="asyncNoWait"/> -->
		<UI />
	</Product>
</Wix>